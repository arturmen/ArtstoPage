<!DOCTYPE html>
<html dir="ltr" lang="en-US">

<head>

	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta name="author" content="SemiColonWeb" />

	<!-- Stylesheets
	============================================= -->
	<link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700|Roboto:300,400,500,700" rel="stylesheet"
	 type="text/css" />
	<link rel="stylesheet" href="css/bootstrap.css" type="text/css" />
	<link rel="stylesheet" href="css/style.css" type="text/css" />

	<!-- One Page Module Specific Stylesheet -->
	<link rel="stylesheet" href="css/onepage.css" type="text/css" />
	<!-- / -->

	<link rel="stylesheet" href="css/dark.css" type="text/css" />
	<link rel="stylesheet" href="font-icons.css" type="text/css" /> 
	<!-- nie mozna dac font-icons do css -->
	<link rel="stylesheet" href="css/et-line.css" type="text/css" />
	<link rel="stylesheet" href="css/animate.css" type="text/css" />
	<link rel="stylesheet" href="css/magnific-popup.css" type="text/css" />

	<link rel="stylesheet" href="css/fonts.css" type="text/css" />

	<!-- inserting a favicon using realfavicongenerator -->
	<link rel="apple-touch-icon" sizes="180x180" href="assets/icons/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="assets/icons/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="assets/icons/favicon-16x16.png">
	<link rel="manifest" href="assets/icons/site.webmanifest">
	<link rel="mask-icon" href="assets/icons/safari-pinned-tab.svg" color="#5b93d5">
	<meta name="msapplication-TileColor" content="#b91d47">
	<meta name="theme-color" content="#ffffff">
	<!-- / -->

	<link rel="stylesheet" href="css/responsive.css" type="text/css" />
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

	<!-- Document Title
	============================================= -->
	<title>Artsto | Galeria</title>

</head>

<body class="stretched side-push-panel">

	<div class="body-overlay"></div>

	<div id="side-panel" class="dark">

		<div id="side-panel-trigger-close" class="side-panel-trigger"><a href="#"><i class="icon-line-cross"></i></a></div>

		<div class="side-panel-wrap">

			<div class="widget widget_links clearfix">

				<h4>Kontakt</h4>

				<div style="font-size: 14px; line-height: 1.7;">


					<address style="line-height: 1.7;">
						Artsto Sp. z.o.o<br>
						ul. Dworska 147<br>
						38-430 Rogi<br>
					</address>

					<div class="clear topmargin-sm"></div>

					<abbr title="Phone Number">Telefon:</abbr> 605 038 635<br>
					<abbr title="Phone Number">Telefon:</abbr> 13 43 535 69<br>
					<abbr title="Email Address">Email:</abbr> robertmuron@op.pl<br>
					<abbr title="Email Address">Email:</abbr> biuro@artsto.pl
				</div>

			</div>



		</div>

	</div>

	<!-- Document Wrapper
	============================================= -->
	<div id="wrapper" class="clearfix">

		<!-- Header
		============================================= -->
		<header id="header" class="full-header transparent-header border-full-header dark static-sticky" data-sticky-class="not-dark"
		 data-sticky-offset="full" data-sticky-offset-negative="1000">

			<div id="header-wrap">

				<div class="container clearfix">

					<div id="primary-menu-trigger"><i class="icon-reorder"></i></div>

					<!-- Logo
					============================================= -->
					<div id="logo">
						<a href="index.html" class="standard-logo" data-dark-logo="assets/images/logo/logo-artsto-dark.png"><img src="assets/images/logo/logo-artsto-dark.png"
							 alt="Artsto Logo"></a>
						<a href="index.html" class="retina-logo" data-dark-logo="assets/images/logo/logo-artsto-dark.png"><img src="assets/images/logo/logo-artsto-dark.png"
							 alt="Artsto Logo"></a>
					</div><!-- #logo end -->

					<!-- Primary Navigation
					============================================= -->
					<nav id="primary-menu">
						<ul class="one-page-menu" data-easing="easeInOutExpo" data-speed="1250" data-offset="65">
							<li><a href="index.html">
									<div>Strona główna</div>
								</a></li>
						</ul>
						<div id="side-panel-trigger" class="side-panel-trigger"><a href="#"><i class="icon-reorder"></i></a></div>

					</nav><!-- #primary-menu end -->

				</div>

			</div>

		</header><!-- #header end -->

		<!-- Page Title
		============================================= -->
		<section id="page-title">

			<div class="container clearfix">
				<h1>Galeria naszych produktów</h1>
			</div>

		</section><!-- #page-title end -->

		<!-- Content
		============================================= -->
		<section id="content">

			<div class="content-wrap">

				<div class="container clearfix">

					<!-- Portfolio Filter
					============================================= -->
					<ul id="target-product-filters" class="portfolio-filter clearfix" data-container="#target-gallery-items">
					</ul><!-- #portfolio-filter end -->

					<script type="text/template" id="template-product-filters">
						{{#filters}}
						<li><a href="#" data-filter="{{tag}}">{{name}}</a></li>
						{{/filters}}
					</script>


					<div id="portfolio-shuffle" class="portfolio-shuffle" data-container="#portfolio">
						<i class="icon-random"></i>
					</div>

					<div class="clear"></div>

					<!-- Portfolio Items
					============================================= -->
					<div id="target-gallery-items" class="portfolio grid-container portfolio-masonry clearfix ">
					</div><!-- #portfolio end -->

					<script type="text/template" id="template-gallery-items">
						{{#products}}
						<article class="portfolio-item {{pf-filters}}">
							<div class="portfolio-image">
								<div class="fslider" data-arrows="false" data-speed="400" data-pause="4000">
									<div class="flexslider">
										<div class="slider-wrap">
											{{#images_all}}
											<div class="slide"><a href="portfolio-single-gallery.html"><img src="{{source}}" alt="{{name}}"></a></div>
											{{/images_all}}
										</div>
									</div>
								</div>
								<div class="portfolio-overlay" data-lightbox="gallery">
									{{#images_all}}
									<a href="{{source}}" class="left-icon" data-lightbox="gallery-item"><i class="icon-line-stack-2"></i></a>
									{{/images_all}}
									<a href="product.html?name={{name_url}}" class="right-icon"><i class="icon-line-ellipsis"></i></a>
								</div>
							</div>
							<div class="portfolio-desc">
								<h3><a href="product.html?name={{name_url}}" > {{name}}</a></h3>
								<span><a>{{instance_color}}</a></span>
							</div>
						</article>
						{{/products}} 
					</script>

				</div>
			</div>

		</section><!-- #content end -->

		<!-- Footer
		============================================= -->
		<footer id="footer" class="dark noborder">

			<div class="container center">
				<div class="footer-widgets-wrap">

					<div class="row divcenter clearfix">

						<div class="col-lg-6">

							<div class="widget clearfix">
								<h4>Linki</h4>

								<ul class="list-unstyled footer-site-links nobottommargin">
									<li><a href="index.html" data-scrollto="index.html#wrapper" data-easing="easeInOutExpo" data-speed="1250"
										 data-offset="70">Strona główna</a></li>
								</ul>
							</div>
						</div>

						<div class="col-lg-6">
							<div class="widget clearfix">
								<h4>Kontakt</h4>
								<p class="lead">Artsto Sp. z.o.o<br>ul. Dworska 147<br>38-430 Rogi<br></p>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div id="copyrights">
				<div class="container center clearfix">
					Copyright © Artsto 2018 | Wszystkie prawa zastrzeżone
				</div>
			</div>

		</footer><!-- #footer end -->

	</div><!-- #wrapper end -->

	<!-- Go To Top
	============================================= -->
	<div id="gotoTop" class="icon-angle-up"></div>

	<!-- External JavaScripts
	============================================= -->
	<script src="js/jquery.js"></script>
	<script src="js/plugins.js"></script>

	<!-- Google Map JavaScripts
	============================================= -->
	<script src="https://maps.google.com/maps/api/js?key=AIzaSyCQHDzHzLzAmzyx3YSP7otOIR8k0MVlImM" async defer></script>
	<script src="js/jquery.gmap.js"></script>


	<!-- Templating library -->
	<script src="https://cdn.rawgit.com/janl/mustache.js/master/mustache.min.js"></script>

	<!-- Footer Scripts
	============================================= -->
	<script src="js/functions.js"></script>

	<script src="js/utils.js"></script>

	<script>
		function getProductFilters(product, color) {
			var fs = []

			fs.push(filterifyName(product.category))
			fs.push(filterifyName(product.name))

			if (typeof color === "undefined") {
				for (var idx in product.materials.wood) {
					color = product.materials.wood[idx]
					fs.push(filterifyName(color))
				}
			} else {
				fs.push(filterifyName(color))
			}

			return fs
		}

		function filterGalleryImages(images) {
			return images.filter(function (image) {
				return !(('gallery' in image) && (image.gallery === false));
			});
		}

		function renderTemplates(content) {
			console.log(content)

			// filters
			// TODO extract(wiktor)
			var template = $('#template-product-filters').html();
			Mustache.parse(template);

			var filters = [{ "name": "Wszystko", "tag": "*" }]
			for (var idx in content.categories) {
				category = content.categories[idx]
				filters.push({
					"name": category,
					"tag": "." + filterifyName(category)
				})
			}

			for (var idx in content.products) {
				product = content.products[idx]
				filters.push({
					"name": product.name,
					"tag": "." + filterifyName(product.name)
				})
			}

			for (var key in content.materials.wood) {
				color = content.materials.wood[key]
				filters.push({
					"name": color.name,
					"tag": "." + filterifyName(color.name)
				})
			}

			var rendered = Mustache.render(template, { "filters": filters });
			$('#target-product-filters').html(rendered);
			$('#target-product-filters li:first').addClass('activeFilter');

			// TODO (wiktor) maybe group by color? TBD
			var productInstances = []

			// render gallery items
			var products = content.products
			for (var productIdx in products) {
				var p = products[productIdx];

				var imagesForGallery = filterGalleryImages(p.images.all)
				for (imageIdx in imagesForGallery) {
					var copy = jQuery.extend(true, {}, p);
					var image = imagesForGallery[imageIdx]

					copy["pf-filters"] = getProductFilters(p, image.color).join(" ");
					copy["images_all"] = [image];
					copy["name_url"] = sanitazeName(p.name);
					copy["instance_color"] = image.color

					productInstances.push(copy)
				}
			}

			var template = $('#template-gallery-items').html();
			Mustache.parse(template);
			var rendered = Mustache.render(template, { "products": productInstances });
			$('#target-gallery-items').html(rendered);

			var el = $('.portfolio-overlay a:first');
			el.removeClass('hidden')
			el.addClass('left-icon');
		}

		$.getJSON("data/artsto_data.json", function (data) {
			// Parses pseudo-database JSON file and calls the rendering of elements in the HTML file
			renderTemplates(data.content)
		});
	</script>

</body>

</html>